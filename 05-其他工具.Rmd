# 其他工具

这里介绍一些可以提高LaTeX写作效率的其他工具

## 公式
mathpix

可以很方便的将图片公式转成LaTex形式,手写笔记不太乱的话也是可以识别的.

https://mathpix.com

## 表格

在LaTeX中插入表格并不是很简单的一件事,尤其是当表头需要合并单元格时.
这里介绍一些可以提高输入表格效率的工具.

### xtable包

在R中进行模拟时,将结果输出至LaTeX可以利用这个包中的xtable函数.

https://cran.r-project.org/web/packages/xtable/index.html

```{r}
xtable::xtable(matrix(rnorm(12),3,4))
```

这样我们直接粘贴到LaTeX中就可以了.

但是,这还不够.每次都要复制粘贴仍然很麻烦,而且如果表格的行名、列名有特定的格式,并不能直接粘贴结果(macOS下可以支持选择矩形区域修改).

我们可以利用LaTeX的"\input"指令,完成更酷的操作.

大致流程就是在R中将xtable的输出结果写入文本文件"tableXXXX.tex",然后在tex中需要插入表格的地方"\input"{tableXXXX.tex}.

这样我们每次要把R新计算出来的表格更新到tex中,只需要重新编译一次即可.

关于复杂表头的设计,可以参考这个回答:

https://stackoverflow.com/questions/15036754/r-package-xtable-how-to-create-a-latextable-with-multiple-rows-and-columns-from

比如这样:

```{r}
library(xtable)

C = (rep(0:5,2))
n = rep(c(200,300),each=6)

tau =paste("\\tau=",(rep(c(.25,.5,.75),2)))


data = matrix(runif(6*12),12,6)
data = round(data,3)
df =data.frame(c(replicate(6,"200"),replicate(6,"300")),C,cbind(data[,1:3],rep("",12),data[,4:6]))

# only needed if first column consists of numbers
df[[1]] <- as.character(df[[1]])
rle.lengths <- rle(df[[1]])$lengths
first <- !duplicated(df[[1]])
df[[1]][!first] <- ""

# define appearance of \multirow
df[[1]][first] <-
  paste0("\\multirow{", rle.lengths, "}{*}{{", df[[1]][first], "}}")
addtorow <- list()
addtorow$pos <- list(0, 0, 0)
addtorow$command <- c("\\multirow{2}*{$n$} &\\multirow{2}*{$C$}& \\multicolumn{3}{c}{The homoscedastic cases}&& \\multicolumn{3}{c}{The heteroscedastic cases} \\\\\n",
                      "	\\cline{3-5}     \\cline{7-9} ",
                      "&& $\\tau=0.25$ & $\\tau=0.5$ & $\\tau=0.75$ && $\\tau=0.25$ & $\\tau=0.5$ & $\\tau=0.75$ \\\\\n")
xtable(df,digits = c(0,0,0,rep(2,3),0,rep(2,3))
       ,caption = "测试"
       ,align = "cccccccccc"  # align and put a vertical line (first "l" again represents column of row numbers)
       ,label = "tab::test"
       ,hline.after=NULL, #We don't need hline; we use booktabs
       floating=TRUE # whether \begin{Table} should be created (TRUE) or not (FALSE)
) -> outtable

#
print(outtable,
          hline.after = c(-1,0,nrow(outtable),nrow(outtable)-6),
          #booktabs = TRUE,
          sanitize.text.function = force # Important to treat content of first column as latex function
          ,caption.placement = "top" #"top", NULL
          ,type = "latex"
          ,add.to.row = addtorow,include.colnames = FALSE,include.rownames = FALSE)

```

也支持生成html的形式.

### Excel2LaTeX

可以在Excel中合并好单元格,导出tex的表格.

https://github.com/krlmlr/Excel2LaTeX/releases

### LaTeX中合并单元格

http://www.tablesgenerator.com/#

